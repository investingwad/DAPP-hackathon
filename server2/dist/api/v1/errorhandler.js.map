{"version":3,"sources":["../../../src/api/v1/errorhandler.js"],"names":["smartcontracterr","oreerr","incompleteargs","dotenv","require","config","err","msg","toString","split","console","log","ermsg","errorObj","errmsg","length","el","find","a","includes","trx","quotaerr","keyexist","irreleventauth","toLowerCase","errors","smartcontract_error","uniquekey","smserver","trxnotfound","cpulimit","ramlimit","invalidtrx","singletonerr","hashvalidation","claimnotfound","usernotfound","whitelistnotpresent","transactiontooklong","quotaerror","irrelevantauth","default","errdet","response","status","data","error","errorCode","errorMessage","ORE_error","trxrejected","oreserver","badWalletPassword","userexist","errorcreatewallet","migrate_native","migrate_not_virtual","migrate_err","method","parameter","missingparams","email","push","name","pin","account_type","account_name","claim_id","claim_data","attribute_key","main_account_name","result_id","transaction_id"],"mappings":"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","file":"errorhandler.js","sourcesContent":["const dotenv = require('dotenv')\ndotenv.config()\nconst config = require('./configpath')\n\nexport async function smartcontracterr(err) {\n  // console.log(\"err--\", err)\n  let msg = err.toString().split(':')\n  if (msg) {\n    console.log('msg--', msg)\n    let ermsg\n    let errorObj = {}\n    let errmsg = msg[msg.length - 1]\n    ermsg = errmsg\n    var el = msg.find(\n      a => a.includes('FetchError') || a.includes('ECONNREFUSED')\n    )\n    var trx = msg.find(a => a.includes('not found in history'))\n    var quotaerr = msg.find(a => a.includes(' not enough quota for this provider'))\n    var keyexist = msg.find(a => a.includes('uniqueness constraint was violated'))\n    var irreleventauth = msg.find(a => a.includes('action declares irrelevant authority'))\n    if (trx) ermsg = 'TRXNOTFOUND'\n    if (el) ermsg = 'econnrefused'\n    if (irreleventauth) ermsg = 'irreleventauth'\n    if (quotaerr) ermsg = 'quotanull'\n    if (keyexist) ermsg = ' key already exists'\n    switch (ermsg.toString().toLowerCase()) {\n      case ' key already exists':\n        console.log('key constarints')\n        errorObj = config.errors.smartcontract_error.uniquekey\n        break\n      case 'econnrefused':\n        console.log('connection error')\n        errorObj = config.errors.smartcontract_error.smserver\n        break\n      case 'trxnotfound':\n        console.log('transaction not found')\n        errorObj = config.errors.smartcontract_error.trxnotfound\n        break\n\n      case ' transaction exceeded the current network usage limit imposed on the transaction':\n        console.log('limited CPU')\n        errorObj = config.errors.smartcontract_error.cpulimit\n        break\n\n      case ' account using more than allotted ram':\n        console.log('RAM shortage')\n        errorObj = config.errors.smartcontract_error.ramlimit\n        break\n\n      case ' invalid packed transaction':\n        console.log('packed transaction')\n        errorObj = config.errors.smartcontract_error.invalidtrx\n        break\n      case ' singleton does not exist':\n        console.log('singleton does not exist')\n        errorObj = config.errors.smartcontract_error.singletonerr\n        break\n      case ' hash validation failed':\n        console.log('validation of hash failed')\n        errorObj = config.errors.smartcontract_error.hashvalidation\n        break\n      case ' claim data not present':\n        console.log('claim data not found')\n        errorObj = config.errors.smartcontract_error.claimnotfound\n        break\n      case ' user entry not present in usertrack table':\n        console.log('claim data not found')\n        errorObj = config.errors.smartcontract_error.usernotfound\n        break\n      case ' whitelisted user not present':\n        console.log('whitelisted user not present')\n        errorObj = config.errors.smartcontract_error.whitelistnotpresent\n        break\n      case ' transaction took too long':\n        console.log('transaction took too long')\n        errorObj = config.errors.smartcontract_error.transactiontooklong\n        break\n      case 'quotanull':\n        console.log('quota consumed')\n        errorObj = config.errors.smartcontract_error.quotaerror\n        break\n        case 'irreleventauth':\n        console.log('irreleventauth')\n        errorObj = config.errors.smartcontract_error.irrelevantauth\n        break\n      default:\n        console.log('default')\n        errorObj = config.errors.smartcontract_error.default\n    }\n    return errorObj\n  }\n}\n\nexport async function oreerr(err) {\n  let ermsg\n  let errdet\n  let errorObj = {}\n  console.log(\"err:\", err)\n  if (err.response.status == 400) {\n    ermsg = err.response.data.error\n  } else if (err.response.status == 500) {\n    ermsg = err.response.data.errorCode\n    errdet = err.response.data.errorMessage\n  }\n  console.log('-->', ermsg)\n  switch (ermsg.toString().toLowerCase()) {\n    case 'transactionrejected':\n      console.log('transaction got rejected')\n      errorObj = config.errors.ORE_error.trxrejected\n      break\n    case 'econnrefused':\n      console.log('key constarints')\n      errorObj = config.errors.ORE_error.oreserver\n      break\n    case 'badwalletpassword':\n      console.log('invalid pin')\n      errorObj = config.errors.ORE_error.badWalletPassword\n      break\n\n    case 'useralreadyexists':\n      console.log('user exist')\n      errorObj = config.errors.ORE_error.userexist\n      break\n\n    case 'errorCreateWallet':\n      console.log('Issue creating chain account permissions')\n      errorObj = config.errors.ORE_error.errorcreatewallet\n      break\n\n    case 'error: user not found':\n      console.log('user not found')\n      errorObj = config.errors.ORE_error.usernotfound\n      break\n\n    case 'migratecustodialaccounterror':\n      console.log('migrate error')\n      if (errdet.includes('Invalid existing account type: native')) {\n        errorObj = config.errors.ORE_error.migrate_native\n      } else if (errdet.includes(\"doesn't have an existing virtual account\")) {\n        errorObj = config.errors.ORE_error.migrate_not_virtual\n      } else if (errdet.includes(\"Account is already a native account\")) {\n        errorObj = config.errors.ORE_error.migrate_native\n      } else errorObj = config.errors.ORE_error.migrate_err\n\n      break\n\n    default:\n      console.log('default')\n      errorObj = config.errors.ORE_error.default\n  }\n  return errorObj\n}\n\nexport async function incompleteargs(method, parameter) {\n  console.log('-->', method)\n  let errorObj = {}\n  let missingparams = []\n  switch (method) {\n    case 'signup':\n      console.log('signup')\n      if (!parameter.email) missingparams.push('email')\n      if (!parameter.name) missingparams.push('name')\n      if (!parameter.pin) missingparams.push('pin')\n      if (!parameter.account_type) missingparams.push('account_type')\n      errorObj.missingparams = missingparams\n      break\n\n    case 'login':\n      console.log('login')\n      if (!parameter.account_name) missingparams.push('account_name')\n      if (!parameter.pin) missingparams.push('pin')\n      if (!parameter.account_type) missingparams.push('account_type')\n      errorObj.missingparams = missingparams\n      break\n\n    case 'claim':\n      console.log('claim')\n      if (!parameter.account_name) missingparams.push('account_name')\n      if (!parameter.pin) missingparams.push('pin')\n      if (!parameter.account_type) missingparams.push('account_type')\n      if (!parameter.claim_id) missingparams.push('claim_id')\n      if (!parameter.claim_data) missingparams.push('claim_data')\n      if (!parameter.attribute_key) missingparams.push('attribute_key')\n      errorObj.missingparams = missingparams\n      break\n\n    case 'whitelist':\n      console.log('whitelist')\n      if (!parameter.account_name) missingparams.push('account_name')\n      if (!parameter.main_account_name) missingparams.push('main_account_name')\n      errorObj.missingparams = missingparams\n      break\n\n    case 'verifyres':\n      console.log('verifyresult')\n      if (!parameter.account_name) missingparams.push('account_name')\n      if (!parameter.pin) missingparams.push('pin')\n      if (!parameter.main_account_name) missingparams.push('main_account_name')\n      if (!parameter.claim_id) missingparams.push('claim_id')\n      if (!parameter.claim_data) missingparams.push('claim_data')\n      if (!parameter.result_id) missingparams.push('result_id')\n      errorObj.missingparams = missingparams\n      break\n\n    case 'get_verification_result':\n      console.log('verification result')\n      if (!parameter.result_id) missingparams.push('result_id')\n      errorObj.missingparams = missingparams\n      break\n\n    case 'migrate':\n      console.log('migrate')\n      if (!parameter.account_name) missingparams.push('account_name')\n      if (!parameter.pin) missingparams.push('pin')\n      errorObj.missingparams = missingparams\n      break\n\n    case 'gettransaction':\n      console.log('get transaction')\n      if (!parameter.transaction_id) missingparams.push('transaction_id')\n      errorObj.missingparams = missingparams\n      break\n\n    default:\n      console.log('default')\n      errorObj = config.errors.ORE_error.default\n  }\n  return errorObj\n}\n"]}